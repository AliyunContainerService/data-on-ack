(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9b386f02"],{"0f97":function(t,e,r){},8355:function(t,e,r){"use strict";r("0f97")},9368:function(t,e,r){"use strict";r("a410")},"9ed6":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"login-container"},[r("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:t.loginForm,rules:t.loginRules,"auto-complete":"on","label-position":"left"}},[r("div",{staticClass:"title-container"},[r("h3",{staticClass:"title"},[t._v("管理员登录")])]),r("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{type:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.handleLogin(e)}}},[t._v("使用阿里云RAM账号登录")])],1)],1)},o=[],i=r("c24f"),s={name:"Login",data:function(){return{loginForm:{clientId:"admin",clientSecret:"123456"},loginRules:{clientId:[{required:!0,trigger:"blur",type:"string"}],clientSecret:[{required:!0,trigger:"blur",type:"string"}]},passwordType:"password",redirect:void 0}},watch:{$route:{handler:function(t){this.redirect=t.query&&t.query.redirect},immediate:!0}},methods:{showPwd:function(){var t=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){t.$refs.clientSecret.focus()}))},handleLogin:function(){var t=this;Object(i["b"])().then((function(e){if(void 0===e||void 0===e.data||void 0===e.data.user)throw new Error("not login");var r=e.data.user.spec,n={k8sVersion:e.data.k8sVersion};if(void 0===r.apiRoles)throw new Error("no roles");var o=r.apiRoles;if(o.length<1)throw new Error("auth roles empty");t.$store.dispatch("user/updateUser",{roles:o,userName:r.userName,token:e.data.token,clusterInfo:n}).then((function(){t.$store.dispatch("permission/generateRoutes",[o,n]).then((function(e){t.$router.addRoutes(e)})).catch((function(t){throw console.log("genereate route error:",t),new Error(t)})),t.$router.push({path:t.redirect||"/"})})).catch((function(t){throw new Error(t)}))})).catch((function(){t.$notify({title:"错误",message:"获取用户信息失败，请重新登陆",type:"info",duration:3e3}),window.location="/sp/login"}))}}},a=s,c=(r("8355"),r("9368"),r("2877")),u=Object(c["a"])(a,n,o,!1,null,"7863c6b6",null);e["default"]=u.exports},a410:function(t,e,r){}}]);